<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Vectorise the spatial coordinates — get_vectors • jazzPanda</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Vectorise the spatial coordinates — get_vectors"><meta name="description" content="This function will convert the coordinates into a numeric vector for
genes and clusters."><meta property="og:description" content="This function will convert the coordinates into a numeric vector for
genes and clusters."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">jazzPanda</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/jazzPanda.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/phipsonlab/jazzPanda/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Vectorise the spatial coordinates</h1>
      <small class="dont-index">Source: <a href="https://github.com/phipsonlab/jazzPanda/blob/main/R/get_vectors.R" class="external-link"><code>R/get_vectors.R</code></a></small>
      <div class="d-none name"><code>get_vectors.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function will convert the coordinates into a numeric vector for
genes and clusters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_vectors</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">cluster_info</span>,</span>
<span>  <span class="va">sample_names</span>,</span>
<span>  <span class="va">bin_type</span>,</span>
<span>  <span class="va">bin_param</span>,</span>
<span>  <span class="va">test_genes</span>,</span>
<span>  <span class="va">w_x</span>,</span>
<span>  <span class="va">w_y</span>,</span>
<span>  use_cm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a named list (of transcript detection coordinates) or
SingleCellExperiment or SpatialExperiment or
SpatialFeatureExperiment object. If a named list is provided, every list
element is a dataframe containing the transcript detection
coordinates and column names must include "feature_name" (gene name),
"x" (x coordinate), "y" (y coordinate).
The list names must match samples in cluster_info.</p></dd>


<dt id="arg-cluster-info">cluster_info<a class="anchor" aria-label="anchor" href="#arg-cluster-info"></a></dt>
<dd><p>A dataframe/matrix containing the centroid coordinates,
cluster label and sample for each cell.The column names must include
"x" (x coordinate), "y" (y coordinate),
"cluster" (cluster label) and "sample" (sample). It is strongly recommended
to use syntactically valid names for columns clusters and samples.
If invalid names are detected, the function <code><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names</a></code> will be
employed to generate valid names. A message will also be displayed to
indicate this change.</p></dd>


<dt id="arg-sample-names">sample_names<a class="anchor" aria-label="anchor" href="#arg-sample-names"></a></dt>
<dd><p>a vector of strings giving the sample names.
It is strongly recommended to use syntactically valid names for columns
clusters and samples. If invalid names are detected, the function
<code><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names</a></code> will be employed to generate valid names.
A message will also be displayed to indicate this change.</p></dd>


<dt id="arg-bin-type">bin_type<a class="anchor" aria-label="anchor" href="#arg-bin-type"></a></dt>
<dd><p>A string indicating which bin shape is to be used for
vectorization. One of "square" (default), "rectangle", or "hexagon".</p></dd>


<dt id="arg-bin-param">bin_param<a class="anchor" aria-label="anchor" href="#arg-bin-param"></a></dt>
<dd><p>A numeric vector indicating the size of the bin. If the
<code>bin_type</code> is "square" or "rectangle", this will be a vector of length
two giving the numbers of rectangular quadrats in the x and y directions. If
the <code>bin_type</code> is "hexagonal", this will be a number giving the side
length of hexagons. Positive numbers only.</p></dd>


<dt id="arg-test-genes">test_genes<a class="anchor" aria-label="anchor" href="#arg-test-genes"></a></dt>
<dd><p>A vector of strings giving the name of the genes you want
to create gene vector. This will be used as column names for one of the
result matrix <code>gene_mt</code>.</p></dd>


<dt id="arg-w-x">w_x<a class="anchor" aria-label="anchor" href="#arg-w-x"></a></dt>
<dd><p>A numeric vector of length two specifying the x coordinate
limits of enclosing box.</p></dd>


<dt id="arg-w-y">w_y<a class="anchor" aria-label="anchor" href="#arg-w-y"></a></dt>
<dd><p>A numeric vector of length two specifying the y coordinate
limits of enclosing box.</p></dd>


<dt id="arg-use-cm">use_cm<a class="anchor" aria-label="anchor" href="#arg-use-cm"></a></dt>
<dd><p>A boolean value that specifies whether to create spatial
vectors for genes using the count matrix and cell coordinates instead of
the transcript coordinates when both types of information are available.
The default setting is FALSE.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>A positive number specifying number of cores used for
parallelizing permutation testing. Default is one core
(sequential processing).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list of two matrices with the following components</p>
<dl><dt><code>gene_mt</code>  </dt>
<dd><p>contains the transcript count in each grid.
Each row refers to a grid, and each column refers to a gene.</p></dd>

<dt><code>cluster_mt</code>  </dt>
<dd><p>contains the number of cells in a specific
cluster in each grid. Each row refers to a grid, and each column refers
to a cluster.</p></dd>

</dl><p>The row order of <code>gene_mt</code> matches the row order of <code>cluster_mt</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function can be used to generate input for <code><a href="lasso_markers.html">lasso_markers</a></code>
by specifying all the parameters.</p>
<p>Suppose the input data contains \(n\) genes, \(c\) clusters, and
\(k\) samples, we
want to use \(a \times a\) square bin to convert the coordinates
of genes and clusters into 1d vectors.</p>
<p>If \(k=1\), the returned list will contain one matrix for gene vectors
(<code>gene_mt</code>) of dimension \(a^2 \times n\) and one matrix for
cluster vectors (<code>cluster_mt</code>) of dimension \(a^2 \times c\).</p>
<p>If \(k&gt;1\), gene and cluster vectors are constructed for each sample
separately and concat together. There will be additional k columns on the
returned <code>cluster_mt</code>, which is the one-hot encoding of the
sample information.</p>
<p>Moreover, this function can vectorise genes and clusters separately based
on the input. If <code>x</code> is NULL, this function will
return vectorised clusters based on <code>cluster_info</code>.
If <code>cluster_info</code> is NULL, this function will return vectorised genes
based on <code>x</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/drighelli/SpatialExperiment" class="external-link">SpatialExperiment</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#  simulate coordinates for clusters</span></span></span>
<span class="r-in"><span><span class="va">df_clA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">20</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">20</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, cluster<span class="op">=</span><span class="st">"A"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_clB</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">100</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">100</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, cluster<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">clusters</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_clA</span>, <span class="va">df_clB</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clusters</span><span class="op">$</span><span class="va">sample</span><span class="op">=</span><span class="st">"sample1"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate coordinates for genes</span></span></span>
<span class="r-in"><span><span class="va">trans_info</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, mean<span class="op">=</span><span class="fl">20</span>,sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, mean<span class="op">=</span><span class="fl">20</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 feature_name<span class="op">=</span><span class="st">"gene_A1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, mean<span class="op">=</span><span class="fl">20</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, mean<span class="op">=</span><span class="fl">20</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 feature_name<span class="op">=</span><span class="st">"gene_A2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, mean<span class="op">=</span><span class="fl">100</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, mean<span class="op">=</span><span class="fl">100</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 feature_name<span class="op">=</span><span class="st">"gene_B1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, mean<span class="op">=</span><span class="fl">100</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, mean<span class="op">=</span><span class="fl">100</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 feature_name<span class="op">=</span><span class="st">"gene_B2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trans_info</span><span class="op">$</span><span class="va">x</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">trans_info</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trans_info</span><span class="op">$</span><span class="va">y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">trans_info</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trans_info</span><span class="op">$</span><span class="va">cell</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cell1"</span>,<span class="st">"cell2"</span>,<span class="st">"cell2"</span><span class="op">)</span>,replace<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                        size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">trans_info</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w_x</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">trans_info</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">trans_info</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w_y</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">trans_info</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">trans_info</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># use named list as input</span></span></span>
<span class="r-in"><span><span class="va">vecs_lst</span> <span class="op">=</span> <span class="fu">get_vectors</span><span class="op">(</span>x<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sample1"</span> <span class="op">=</span> <span class="va">trans_info</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    sample_names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    cluster_info <span class="op">=</span> <span class="va">clusters</span>,</span></span>
<span class="r-in"><span>                    bin_type <span class="op">=</span> <span class="st">"square"</span>,</span></span>
<span class="r-in"><span>                    bin_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    test_genes <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene_A1"</span>,<span class="st">"gene_A2"</span>,<span class="st">"gene_B1"</span>,<span class="st">"gene_B2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    w_x <span class="op">=</span> <span class="va">w_x</span>, w_y<span class="op">=</span><span class="va">w_y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># use SpatialExperiment object as input</span></span></span>
<span class="r-in"><span><span class="va">trans_mol</span> <span class="op">&lt;-</span> <span class="fu">BumpyMatrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BumpyMatrix/man/splitAsBumpyMatrix.html" class="external-link">splitAsBumpyMatrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">trans_info</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>    row <span class="op">=</span> <span class="va">trans_info</span><span class="op">$</span><span class="va">feature_name</span>, col <span class="op">=</span> <span class="va">trans_info</span><span class="op">$</span><span class="va">cell</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spe</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment.html" class="external-link">SpatialExperiment</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>     assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>molecules <span class="op">=</span> <span class="va">trans_mol</span><span class="op">)</span>,sample_id <span class="op">=</span><span class="st">"sample1"</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vecs_lst_spe</span> <span class="op">=</span> <span class="fu">get_vectors</span><span class="op">(</span>x<span class="op">=</span><span class="va">spe</span>,sample_names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    cluster_info <span class="op">=</span> <span class="va">clusters</span>,</span></span>
<span class="r-in"><span>                    bin_type <span class="op">=</span> <span class="st">"square"</span>,</span></span>
<span class="r-in"><span>                    bin_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    test_genes <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene_A1"</span>,<span class="st">"gene_A2"</span>,<span class="st">"gene_B1"</span>,<span class="st">"gene_B2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    w_x <span class="op">=</span> <span class="va">w_x</span>, w_y<span class="op">=</span><span class="va">w_y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Melody Jin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

